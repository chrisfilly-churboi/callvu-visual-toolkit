<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Micro App Visual Toolkit</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', system-ui, sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useRef } = React;

    // ============================================
    // THEME SYSTEM - 8 Accent Colors
    // ============================================
    const themes = {
      purple: {
        name: 'Purple',
        accent: '#7C3AED',
        accentLight: '#EDE9FE',
        accentMid: '#DDD6FE',
      },
      blue: {
        name: 'Blue',
        accent: '#3B82F6',
        accentLight: '#DBEAFE',
        accentMid: '#BFDBFE',
      },
      teal: {
        name: 'Teal',
        accent: '#14B8A6',
        accentLight: '#CCFBF1',
        accentMid: '#99F6E4',
      },
      green: {
        name: 'Green',
        accent: '#10B981',
        accentLight: '#D1FAE5',
        accentMid: '#A7F3D0',
      },
      cyan: {
        name: 'Cyan',
        accent: '#0891B2',
        accentLight: '#CFFAFE',
        accentMid: '#A5F3FC',
      },
      orange: {
        name: 'Orange',
        accent: '#F59E0B',
        accentLight: '#FEF3C7',
        accentMid: '#FDE68A',
      },
      pink: {
        name: 'Pink',
        accent: '#EC4899',
        accentLight: '#FCE7F3',
        accentMid: '#FBCFE8',
      },
      slate: {
        name: 'Slate',
        accent: '#475569',
        accentLight: '#F1F5F9',
        accentMid: '#E2E8F0',
      },
    };

    // Neutral colors
    const colors = {
      white: '#FFFFFF',
      gray50: '#F9FAFB',
      gray100: '#F3F4F6',
      gray200: '#E5E7EB',
      gray300: '#D1D5DB',
      gray400: '#9CA3AF',
      gray500: '#6B7280',
      gray600: '#4B5563',
      gray700: '#374151',
      gray800: '#1F2937',
      gray900: '#111827',
      success: '#22C55E',
    };

    // ============================================
    // PRIMITIVE COMPONENTS
    // ============================================

    // Micro App Container
    const MicroAppCard = ({ children, width = 340 }) => (
      <div style={{
        width,
        background: colors.white,
        borderRadius: 20,
        padding: 24,
        boxShadow: '0 20px 40px rgba(0,0,0,0.1), 0 8px 16px rgba(0,0,0,0.06)',
      }}>
        {children}
      </div>
    );

    // Header with Icon
    const MicroAppHeader = ({ icon, title, subtitle, theme = 'purple', showStatus = true }) => {
      const t = themes[theme];
      return (
        <div style={{ display: 'flex', alignItems: 'center', gap: 14, marginBottom: 20 }}>
          <div style={{
            width: 48,
            height: 48,
            borderRadius: 12,
            background: t.accentLight,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            color: t.accent,
          }}>
            {icon}
          </div>
          <div style={{ flex: 1 }}>
            <h2 style={{ fontSize: 17, fontWeight: 700, color: colors.gray900, margin: 0 }}>{title}</h2>
            <p style={{ fontSize: 13, color: colors.gray500, margin: '2px 0 0 0' }}>{subtitle}</p>
          </div>
          {showStatus && (
            <div style={{
              width: 10,
              height: 10,
              borderRadius: '50%',
              background: colors.success,
            }} />
          )}
        </div>
      );
    };

    // Amount/Value Display Card
    const ValueCard = ({ label, value, subtitle, theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <div style={{
          background: colors.gray50,
          borderRadius: 14,
          padding: '20px 24px',
          textAlign: 'center',
          marginBottom: 16,
        }}>
          <div style={{
            fontSize: 11,
            fontWeight: 700,
            color: t.accent,
            textTransform: 'uppercase',
            letterSpacing: 1.2,
            marginBottom: 8,
          }}>
            {label}
          </div>
          <div style={{
            fontSize: 36,
            fontWeight: 800,
            color: colors.gray900,
            letterSpacing: -1,
            marginBottom: 4,
          }}>
            {value}
          </div>
          {subtitle && (
            <div style={{ fontSize: 14, color: colors.gray500 }}>
              {subtitle}
            </div>
          )}
        </div>
      );
    };

    // Info Row (like payment method)
    const InfoRow = ({ icon, label, value, theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <div style={{
          background: colors.white,
          border: `1px solid ${colors.gray200}`,
          borderRadius: 12,
          padding: '14px 16px',
          display: 'flex',
          alignItems: 'center',
          gap: 12,
          marginBottom: 16,
        }}>
          {icon && (
            <div style={{
              background: t.accent,
              color: colors.white,
              fontSize: 10,
              fontWeight: 700,
              padding: '6px 10px',
              borderRadius: 6,
            }}>
              {icon}
            </div>
          )}
          <span style={{ fontSize: 16, fontWeight: 600, color: colors.gray800, letterSpacing: 1 }}>
            {label} {value}
          </span>
        </div>
      );
    };

    // CTA Button
    const CTAButton = ({ children, theme = 'purple', fullWidth = true }) => {
      const t = themes[theme];
      return (
        <button style={{
          width: fullWidth ? '100%' : 'auto',
          background: t.accent,
          color: colors.white,
          border: 'none',
          borderRadius: 14,
          padding: '18px 24px',
          fontSize: 16,
          fontWeight: 700,
          cursor: 'pointer',
        }}>
          {children}
        </button>
      );
    };

    // Secondary Button
    const SecondaryButton = ({ children, theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <button style={{
          width: '100%',
          background: t.accentLight,
          color: t.accent,
          border: 'none',
          borderRadius: 14,
          padding: '16px 24px',
          fontSize: 15,
          fontWeight: 600,
          cursor: 'pointer',
        }}>
          {children}
        </button>
      );
    };

    // Text Input Field
    const InputField = ({ label, placeholder, type = 'text', theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <div style={{ marginBottom: 16 }}>
          {label && (
            <label style={{
              display: 'block',
              fontSize: 12,
              fontWeight: 600,
              color: colors.gray600,
              marginBottom: 8,
              textTransform: 'uppercase',
              letterSpacing: 0.5,
            }}>
              {label}
            </label>
          )}
          <div style={{
            background: colors.gray50,
            border: `1px solid ${colors.gray200}`,
            borderRadius: 12,
            padding: '14px 16px',
            fontSize: 15,
            color: colors.gray400,
          }}>
            {placeholder}
          </div>
        </div>
      );
    };

    // Select/Dropdown Field
    const SelectField = ({ label, value, theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <div style={{ marginBottom: 16 }}>
          {label && (
            <label style={{
              display: 'block',
              fontSize: 12,
              fontWeight: 600,
              color: colors.gray600,
              marginBottom: 8,
              textTransform: 'uppercase',
              letterSpacing: 0.5,
            }}>
              {label}
            </label>
          )}
          <div style={{
            background: colors.white,
            border: `1px solid ${colors.gray200}`,
            borderRadius: 12,
            padding: '14px 16px',
            fontSize: 15,
            color: colors.gray800,
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
          }}>
            <span>{value}</span>
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke={colors.gray400} strokeWidth="2">
              <path d="M6 9l6 6 6-6"/>
            </svg>
          </div>
        </div>
      );
    };

    // List Item Row
    const ListItem = ({ left, right, subtitle, theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <div style={{
          display: 'flex',
          justifyContent: 'space-between',
          alignItems: 'center',
          padding: '14px 0',
          borderBottom: `1px solid ${colors.gray100}`,
        }}>
          <div>
            <div style={{ fontSize: 15, fontWeight: 500, color: colors.gray800 }}>{left}</div>
            {subtitle && <div style={{ fontSize: 13, color: colors.gray500, marginTop: 2 }}>{subtitle}</div>}
          </div>
          <div style={{ fontSize: 15, fontWeight: 600, color: colors.gray900 }}>{right}</div>
        </div>
      );
    };

    // Divider
    const Divider = () => (
      <div style={{ height: 1, background: colors.gray200, margin: '16px 0' }} />
    );

    // Section Label
    const SectionLabel = ({ children, theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <div style={{
          fontSize: 11,
          fontWeight: 700,
          color: t.accent,
          textTransform: 'uppercase',
          letterSpacing: 1.2,
          marginBottom: 12,
        }}>
          {children}
        </div>
      );
    };

    // Icons
    const Icons = {
      card: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <rect x="2" y="5" width="20" height="14" rx="2" opacity="0.3"/>
          <rect x="4" y="9" width="8" height="2" rx="1"/>
        </svg>
      ),
      calendar: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
          <rect x="3" y="4" width="18" height="18" rx="2"/>
          <line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/>
          <line x1="3" y1="10" x2="21" y2="10"/>
        </svg>
      ),
      document: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" opacity="0.3"/>
          <polyline points="14,2 14,8 20,8" fill="none" stroke="currentColor" strokeWidth="2"/>
        </svg>
      ),
      user: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <circle cx="12" cy="8" r="4" opacity="0.3"/>
          <path d="M12 14c-4 0-8 2-8 4v2h16v-2c0-2-4-4-8-4z" opacity="0.5"/>
        </svg>
      ),
      check: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3">
          <polyline points="20,6 9,17 4,12"/>
        </svg>
      ),
      clock: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
          <circle cx="12" cy="12" r="10"/>
          <polyline points="12,6 12,12 16,14"/>
        </svg>
      ),
      location: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" opacity="0.3"/>
          <circle cx="12" cy="9" r="2.5"/>
        </svg>
      ),
      receipt: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M4 2v20l3-2 3 2 3-2 3 2 3-2 3 2V2l-3 2-3-2-3 2-3-2-3 2-3-2z" opacity="0.3"/>
          <line x1="8" y1="8" x2="16" y2="8" stroke="currentColor" strokeWidth="2"/>
          <line x1="8" y1="12" x2="14" y2="12" stroke="currentColor" strokeWidth="2"/>
        </svg>
      ),
      shield: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2L4 6v6c0 5.5 3.4 10.3 8 12 4.6-1.7 8-6.5 8-12V6l-8-4z" opacity="0.3"/>
          <path d="M9 12l2 2 4-4" stroke="currentColor" strokeWidth="2" fill="none" strokeLinecap="round"/>
        </svg>
      ),
      form: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <rect x="3" y="3" width="18" height="18" rx="2" opacity="0.3"/>
          <line x1="7" y1="8" x2="17" y2="8" stroke="currentColor" strokeWidth="2"/>
          <line x1="7" y1="12" x2="17" y2="12" stroke="currentColor" strokeWidth="2"/>
          <line x1="7" y1="16" x2="13" y2="16" stroke="currentColor" strokeWidth="2"/>
        </svg>
      ),
      alert: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2L2 22h20L12 2z" opacity="0.3"/>
          <line x1="12" y1="9" x2="12" y2="13" stroke="currentColor" strokeWidth="2" strokeLinecap="round"/>
          <circle cx="12" cy="17" r="1" fill="currentColor"/>
        </svg>
      ),
      camera: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z" opacity="0.3"/>
          <circle cx="12" cy="13" r="4" stroke="currentColor" strokeWidth="2" fill="none"/>
        </svg>
      ),
      pen: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 20h9" stroke="currentColor" strokeWidth="2" strokeLinecap="round"/>
          <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z" opacity="0.3"/>
        </svg>
      ),
      toggle: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <rect x="1" y="6" width="22" height="12" rx="6" opacity="0.3"/>
          <circle cx="17" cy="12" r="4" fill="currentColor"/>
        </svg>
      ),
      gift: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <rect x="3" y="12" width="18" height="10" rx="1" opacity="0.3"/>
          <rect x="3" y="8" width="18" height="4" rx="1" opacity="0.5"/>
          <path d="M12 8v14M7 8c0-2 1-4 3-4s2 2 2 4M17 8c0-2-1-4-3-4s-2 2-2 4" stroke="currentColor" strokeWidth="2" fill="none"/>
        </svg>
      ),
      plane: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M21 16v-2l-8-5V3.5a1.5 1.5 0 0 0-3 0V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z" opacity="0.5"/>
        </svg>
      ),
      calendarClock: (
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <rect x="3" y="4" width="18" height="18" rx="2" opacity="0.3"/>
          <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" strokeWidth="2"/>
          <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" strokeWidth="2"/>
          <circle cx="12" cy="14" r="4" stroke="currentColor" strokeWidth="2" fill="none"/>
          <polyline points="12,12 12,14 13.5,15" stroke="currentColor" strokeWidth="1.5" fill="none" strokeLinecap="round"/>
        </svg>
      ),
    };

    // ============================================
    // MICRO APP TEMPLATES
    // ============================================

    // 1. PAYMENT (already built)
    const MakePaymentApp = ({ theme = 'purple' }) => (
      <MicroAppCard>
        <MicroAppHeader
          icon={Icons.card}
          title="Make Payment"
          subtitle="Secure checkout"
          theme={theme}
        />
        <ValueCard
          label="Amount Due"
          value="$127.50"
          subtitle="Due Dec 5"
          theme={theme}
        />
        <InfoRow
          icon="VISA"
          label="‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
          value="4582"
          theme={theme}
        />
        <CTAButton theme={theme}>Pay $127.50</CTAButton>
      </MicroAppCard>
    );

    // 2. ID VERIFICATION - Camera viewfinder / scan frame
    const IDVerificationApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.shield}
            title="Verify Identity"
            subtitle="Quick & secure"
            theme={theme}
          />
          {/* Hero: Scan Frame */}
          <div style={{
            background: t.accentLight,
            borderRadius: 16,
            padding: 24,
            marginBottom: 16,
            position: 'relative',
            overflow: 'hidden',
          }}>
            {/* Corner brackets */}
            <div style={{
              position: 'absolute',
              top: 16,
              left: 16,
              width: 40,
              height: 40,
              borderTop: `3px solid ${t.accent}`,
              borderLeft: `3px solid ${t.accent}`,
              borderRadius: '4px 0 0 0',
            }} />
            <div style={{
              position: 'absolute',
              top: 16,
              right: 16,
              width: 40,
              height: 40,
              borderTop: `3px solid ${t.accent}`,
              borderRight: `3px solid ${t.accent}`,
              borderRadius: '0 4px 0 0',
            }} />
            <div style={{
              position: 'absolute',
              bottom: 16,
              left: 16,
              width: 40,
              height: 40,
              borderBottom: `3px solid ${t.accent}`,
              borderLeft: `3px solid ${t.accent}`,
              borderRadius: '0 0 0 4px',
            }} />
            <div style={{
              position: 'absolute',
              bottom: 16,
              right: 16,
              width: 40,
              height: 40,
              borderBottom: `3px solid ${t.accent}`,
              borderRight: `3px solid ${t.accent}`,
              borderRadius: '0 0 4px 0',
            }} />
            {/* ID Card placeholder */}
            <div style={{
              background: colors.white,
              borderRadius: 8,
              height: 100,
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              border: `1px solid ${colors.gray200}`,
              boxShadow: '0 2px 8px rgba(0,0,0,0.06)',
            }}>
              <div style={{ textAlign: 'center' }}>
                <div style={{ color: colors.gray500, fontSize: 13, fontWeight: 500, marginBottom: 4 }}>Position ID in frame</div>
                <div style={{ color: colors.gray400, fontSize: 12 }}>Front of card</div>
              </div>
            </div>
          </div>
          <CTAButton theme={theme}>üì∑ Capture ID</CTAButton>
        </MicroAppCard>
      );
    };

    // 3. FORM INTAKE - Progress stepper dots
    const FormIntakeApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.form}
            title="New Application"
            subtitle="Step 2 of 4"
            theme={theme}
          />
          {/* Hero: Progress Stepper */}
          <div style={{
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center',
            gap: 8,
            marginBottom: 24,
            padding: '16px 0',
          }}>
            {[1, 2, 3, 4].map((step, i) => (
              <React.Fragment key={step}>
                <div style={{
                  width: 32,
                  height: 32,
                  borderRadius: '50%',
                  background: step <= 2 ? t.accent : colors.gray200,
                  color: step <= 2 ? colors.white : colors.gray400,
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  fontSize: 13,
                  fontWeight: 700,
                }}>
                  {step < 2 ? '‚úì' : step}
                </div>
                {i < 3 && (
                  <div style={{
                    width: 32,
                    height: 3,
                    background: step < 2 ? t.accent : colors.gray200,
                    borderRadius: 2,
                  }} />
                )}
              </React.Fragment>
            ))}
          </div>
          <SectionLabel theme={theme}>Personal Information</SectionLabel>
          <InputField label="Full Legal Name" placeholder="Enter your name" theme={theme} />
          <InputField label="Date of Birth" placeholder="MM / DD / YYYY" theme={theme} />
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // 4. DISPUTE/CLAIM - Issue type selector cards
    const DisputeClaimApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const issues = [
        { icon: 'üí≥', label: 'Unauthorized charge' },
        { icon: 'üì¶', label: 'Item not received' },
        { icon: 'üîÑ', label: 'Duplicate charge' },
        { icon: '‚ùå', label: 'Cancelled service' },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.alert}
            title="File a Dispute"
            subtitle="Select issue type"
            theme={theme}
          />
          {/* Hero: Issue selector grid */}
          <div style={{
            display: 'grid',
            gridTemplateColumns: '1fr 1fr',
            gap: 10,
            marginBottom: 20,
          }}>
            {issues.map((issue, i) => (
              <button
                key={i}
                style={{
                  background: i === 0 ? t.accentLight : colors.gray50,
                  border: i === 0 ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                  borderRadius: 12,
                  padding: '16px 12px',
                  textAlign: 'center',
                  cursor: 'pointer',
                }}
              >
                <div style={{ fontSize: 24, marginBottom: 6 }}>{issue.icon}</div>
                <div style={{ 
                  fontSize: 12, 
                  fontWeight: 600, 
                  color: i === 0 ? t.accent : colors.gray700,
                  lineHeight: 1.3,
                }}>
                  {issue.label}
                </div>
              </button>
            ))}
          </div>
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // 5. PHOTO CAPTURE - Upload zone with image preview
    const PhotoCaptureApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.camera}
            title="Upload Document"
            subtitle="Insurance card or ID"
            theme={theme}
          />
          {/* Hero: Upload zone */}
          <div style={{
            border: `2px dashed ${t.accent}`,
            borderRadius: 16,
            padding: 32,
            textAlign: 'center',
            background: t.accentLight,
            marginBottom: 16,
          }}>
            <div style={{
              width: 56,
              height: 56,
              borderRadius: '50%',
              background: colors.white,
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              margin: '0 auto 16px',
              boxShadow: '0 2px 8px rgba(0,0,0,0.08)',
            }}>
              <span style={{ fontSize: 24 }}>üìÑ</span>
            </div>
            <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray800, marginBottom: 4 }}>
              Drag & drop or tap to upload
            </div>
            <div style={{ fontSize: 12, color: colors.gray500 }}>
              JPG, PNG or PDF up to 10MB
            </div>
          </div>
          <div style={{ display: 'flex', gap: 10 }}>
            <SecondaryButton theme={theme}>üì∑ Camera</SecondaryButton>
            <CTAButton theme={theme}>üìÅ Browse</CTAButton>
          </div>
        </MicroAppCard>
      );
    };

    // 6. SIGNATURE - Signature line / pad
    const SignatureApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.pen}
            title="Sign Document"
            subtitle="Your consent is required"
            theme={theme}
          />
          {/* Agreement preview */}
          <div style={{
            background: colors.gray50,
            borderRadius: 12,
            padding: 16,
            marginBottom: 16,
            maxHeight: 80,
            overflow: 'hidden',
            position: 'relative',
          }}>
            <div style={{ fontSize: 12, color: colors.gray600, lineHeight: 1.6 }}>
              I hereby authorize the processing of my information and agree to the terms of service. I understand that this constitutes a legal signature...
            </div>
            <div style={{
              position: 'absolute',
              bottom: 0,
              left: 0,
              right: 0,
              height: 32,
              background: 'linear-gradient(transparent, #F9FAFB)',
            }} />
          </div>
          {/* Hero: Signature pad */}
          <div style={{
            background: colors.white,
            border: `2px solid ${colors.gray200}`,
            borderRadius: 12,
            padding: 20,
            marginBottom: 16,
            minHeight: 100,
            position: 'relative',
          }}>
            {/* Signature line */}
            <div style={{
              position: 'absolute',
              bottom: 32,
              left: 20,
              right: 20,
              borderBottom: `2px solid ${colors.gray300}`,
            }} />
            {/* X marker */}
            <div style={{
              position: 'absolute',
              bottom: 28,
              left: 20,
              fontSize: 18,
              color: colors.gray400,
              fontWeight: 300,
            }}>
              ‚úï
            </div>
            {/* Sample signature scribble */}
            <svg width="120" height="40" viewBox="0 0 120 40" style={{ position: 'absolute', bottom: 36, left: 40 }}>
              <path 
                d="M5 30 Q 15 5, 30 25 T 55 20 T 80 25 T 105 15" 
                stroke={t.accent} 
                strokeWidth="2" 
                fill="none"
                opacity="0.6"
              />
            </svg>
            <div style={{
              position: 'absolute',
              bottom: 8,
              right: 16,
              fontSize: 10,
              color: colors.gray400,
            }}>
              Sign above the line
            </div>
          </div>
          <CTAButton theme={theme}>Accept & Sign</CTAButton>
        </MicroAppCard>
      );
    };

    // 7. SERVICE SELECTION - Toggle cards with checkmarks
    const ServiceSelectionApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const services = [
        { label: 'Start new service', desc: 'Set up at a new address', selected: true },
        { label: 'Stop service', desc: 'Cancel current plan', selected: false },
        { label: 'Transfer service', desc: 'Move to new location', selected: false },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.toggle}
            title="Service Change"
            subtitle="What would you like to do?"
            theme={theme}
          />
          {/* Hero: Selection cards */}
          <div style={{ marginBottom: 20 }}>
            {services.map((svc, i) => (
              <div
                key={i}
                style={{
                  display: 'flex',
                  alignItems: 'center',
                  gap: 14,
                  padding: 16,
                  background: svc.selected ? t.accentLight : colors.white,
                  border: svc.selected ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                  borderRadius: 12,
                  marginBottom: 10,
                  cursor: 'pointer',
                }}
              >
                <div style={{
                  width: 24,
                  height: 24,
                  borderRadius: '50%',
                  background: svc.selected ? t.accent : colors.white,
                  border: svc.selected ? 'none' : `2px solid ${colors.gray300}`,
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  color: colors.white,
                  fontSize: 14,
                  flexShrink: 0,
                }}>
                  {svc.selected && '‚úì'}
                </div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray900 }}>{svc.label}</div>
                  <div style={{ fontSize: 12, color: colors.gray500, marginTop: 2 }}>{svc.desc}</div>
                </div>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // 8. PROGRAM ENROLLMENT - Plan comparison / benefits
    const ProgramEnrollmentApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.gift}
            title="Enroll in Program"
            subtitle="Budget Billing Plan"
            theme={theme}
          />
          {/* Hero: Plan card with benefits */}
          <div style={{
            background: `linear-gradient(135deg, ${t.accent} 0%, ${t.accent}dd 100%)`,
            borderRadius: 16,
            padding: 20,
            marginBottom: 16,
            color: colors.white,
          }}>
            <div style={{ fontSize: 12, opacity: 0.8, marginBottom: 4 }}>MONTHLY AMOUNT</div>
            <div style={{ fontSize: 32, fontWeight: 800, marginBottom: 16 }}>$142/mo</div>
            <div style={{ fontSize: 12, opacity: 0.8 }}>instead of variable bills</div>
          </div>
          {/* Benefits list */}
          <div style={{ marginBottom: 20 }}>
            {['Predictable monthly payments', 'No enrollment fee', 'Cancel anytime'].map((benefit, i) => (
              <div key={i} style={{
                display: 'flex',
                alignItems: 'center',
                gap: 10,
                padding: '10px 0',
                borderBottom: i < 2 ? `1px solid ${colors.gray100}` : 'none',
              }}>
                <div style={{
                  width: 20,
                  height: 20,
                  borderRadius: '50%',
                  background: t.accentLight,
                  color: t.accent,
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  fontSize: 11,
                }}>
                  ‚úì
                </div>
                <span style={{ fontSize: 14, color: colors.gray700 }}>{benefit}</span>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Enroll Now</CTAButton>
        </MicroAppCard>
      );
    };

    // 9. BOOKING/ITINERARY - Trip summary with dates
    const BookingItineraryApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.plane}
            title="Complete Booking"
            subtitle="Review your trip"
            theme={theme}
          />
          {/* Hero: Trip summary */}
          <div style={{
            background: colors.gray50,
            borderRadius: 16,
            padding: 20,
            marginBottom: 16,
          }}>
            <div style={{
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'space-between',
              marginBottom: 16,
            }}>
              <div style={{ textAlign: 'center' }}>
                <div style={{ fontSize: 28, fontWeight: 800, color: colors.gray900 }}>SFO</div>
                <div style={{ fontSize: 11, color: colors.gray500 }}>San Francisco</div>
              </div>
              <div style={{ flex: 1, padding: '0 16px' }}>
                <div style={{
                  height: 2,
                  background: colors.gray300,
                  position: 'relative',
                }}>
                  <div style={{
                    position: 'absolute',
                    top: -8,
                    left: '50%',
                    transform: 'translateX(-50%)',
                    color: t.accent,
                  }}>
                    ‚úà
                  </div>
                </div>
              </div>
              <div style={{ textAlign: 'center' }}>
                <div style={{ fontSize: 28, fontWeight: 800, color: colors.gray900 }}>JFK</div>
                <div style={{ fontSize: 11, color: colors.gray500 }}>New York</div>
              </div>
            </div>
            <div style={{
              display: 'flex',
              justifyContent: 'space-between',
              paddingTop: 16,
              borderTop: `1px solid ${colors.gray200}`,
            }}>
              <div>
                <div style={{ fontSize: 11, color: colors.gray500 }}>DEPART</div>
                <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray800 }}>Dec 15, 8:30am</div>
              </div>
              <div style={{ textAlign: 'right' }}>
                <div style={{ fontSize: 11, color: colors.gray500 }}>RETURN</div>
                <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray800 }}>Dec 22, 6:15pm</div>
              </div>
            </div>
          </div>
          <ValueCard
            label="Total"
            value="$487.00"
            subtitle="2 passengers"
            theme={theme}
          />
          <CTAButton theme={theme}>Pay & Confirm</CTAButton>
        </MicroAppCard>
      );
    };

    // 10. PAYMENT ARRANGEMENT - Installment schedule
    const PaymentArrangementApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const payments = [
        { date: 'Dec 15', amount: '$75.00', status: 'upcoming' },
        { date: 'Jan 15', amount: '$75.00', status: 'scheduled' },
        { date: 'Feb 15', amount: '$77.50', status: 'scheduled' },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.calendarClock}
            title="Payment Plan"
            subtitle="Flexible arrangements"
            theme={theme}
          />
          <ValueCard
            label="Total Balance"
            value="$227.50"
            subtitle="Split into 3 payments"
            theme={theme}
          />
          {/* Hero: Payment timeline */}
          <div style={{ marginBottom: 20 }}>
            {payments.map((pmt, i) => (
              <div key={i} style={{
                display: 'flex',
                alignItems: 'center',
                gap: 14,
                padding: '14px 0',
                borderBottom: i < payments.length - 1 ? `1px solid ${colors.gray100}` : 'none',
              }}>
                {/* Timeline dot and line */}
                <div style={{
                  display: 'flex',
                  flexDirection: 'column',
                  alignItems: 'center',
                  width: 20,
                }}>
                  <div style={{
                    width: 12,
                    height: 12,
                    borderRadius: '50%',
                    background: i === 0 ? t.accent : colors.gray300,
                    border: i === 0 ? 'none' : `2px solid ${colors.gray200}`,
                  }} />
                  {i < payments.length - 1 && (
                    <div style={{
                      width: 2,
                      height: 28,
                      background: colors.gray200,
                      marginTop: 4,
                    }} />
                  )}
                </div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray800 }}>{pmt.date}</div>
                  <div style={{ fontSize: 12, color: colors.gray500, marginTop: 2 }}>
                    {i === 0 ? 'First payment' : 'Scheduled'}
                  </div>
                </div>
                <div style={{
                  fontSize: 16,
                  fontWeight: 700,
                  color: i === 0 ? t.accent : colors.gray600,
                }}>
                  {pmt.amount}
                </div>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Confirm Plan</CTAButton>
        </MicroAppCard>
      );
    };

    // 11. OPEN NEW ACCOUNT - Banking account type selection
    const OpenAccountApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const accounts = [
        { icon: 'üí≥', label: 'Checking', desc: 'Everyday spending', selected: true },
        { icon: 'üê∑', label: 'Savings', desc: 'Earn 4.5% APY', selected: false },
        { icon: 'üìà', label: 'Money Market', desc: 'Higher balances', selected: false },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.form}
            title="Open New Account"
            subtitle="Quick & easy setup"
            theme={theme}
          />
          <SectionLabel theme={theme}>Select Account Type</SectionLabel>
          {/* Hero: Account type cards */}
          <div style={{ marginBottom: 20 }}>
            {accounts.map((acct, i) => (
              <div
                key={i}
                style={{
                  display: 'flex',
                  alignItems: 'center',
                  gap: 14,
                  padding: 16,
                  background: acct.selected ? t.accentLight : colors.white,
                  border: acct.selected ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                  borderRadius: 12,
                  marginBottom: 10,
                  cursor: 'pointer',
                }}
              >
                <div style={{
                  width: 44,
                  height: 44,
                  borderRadius: 10,
                  background: acct.selected ? colors.white : colors.gray50,
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  fontSize: 22,
                }}>
                  {acct.icon}
                </div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 15, fontWeight: 600, color: colors.gray900 }}>{acct.label}</div>
                  <div style={{ fontSize: 12, color: colors.gray500, marginTop: 2 }}>{acct.desc}</div>
                </div>
                <div style={{
                  width: 22,
                  height: 22,
                  borderRadius: '50%',
                  background: acct.selected ? t.accent : colors.white,
                  border: acct.selected ? 'none' : `2px solid ${colors.gray300}`,
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  color: colors.white,
                  fontSize: 12,
                }}>
                  {acct.selected && '‚úì'}
                </div>
              </div>
            ))}
          </div>
          <InputField label="Initial Deposit" placeholder="$0.00" theme={theme} />
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // ============================================
    // FINANCIAL SERVICES VARIANTS
    // ============================================

    // KYC Refresh (ID Verification variant)
    const KYCRefreshApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.shield}
            title="KYC Verification"
            subtitle="Annual compliance refresh"
            theme={theme}
          />
          <div style={{
            background: t.accentLight,
            borderRadius: 16,
            padding: 24,
            marginBottom: 16,
            position: 'relative',
          }}>
            <div style={{ position: 'absolute', top: 16, left: 16, width: 40, height: 40, borderTop: `3px solid ${t.accent}`, borderLeft: `3px solid ${t.accent}`, borderRadius: '4px 0 0 0' }} />
            <div style={{ position: 'absolute', top: 16, right: 16, width: 40, height: 40, borderTop: `3px solid ${t.accent}`, borderRight: `3px solid ${t.accent}`, borderRadius: '0 4px 0 0' }} />
            <div style={{ position: 'absolute', bottom: 16, left: 16, width: 40, height: 40, borderBottom: `3px solid ${t.accent}`, borderLeft: `3px solid ${t.accent}`, borderRadius: '0 0 0 4px' }} />
            <div style={{ position: 'absolute', bottom: 16, right: 16, width: 40, height: 40, borderBottom: `3px solid ${t.accent}`, borderRight: `3px solid ${t.accent}`, borderRadius: '0 0 4px 0' }} />
            <div style={{ background: colors.white, borderRadius: 8, height: 100, display: 'flex', alignItems: 'center', justifyContent: 'center', border: `1px solid ${colors.gray200}` }}>
              <div style={{ textAlign: 'center' }}>
                <div style={{ color: colors.gray500, fontSize: 13, fontWeight: 500, marginBottom: 4 }}>Scan government ID</div>
                <div style={{ color: colors.gray400, fontSize: 12 }}>Passport or Driver's License</div>
              </div>
            </div>
          </div>
          <CTAButton theme={theme}>üì∑ Verify Identity</CTAButton>
        </MicroAppCard>
      );
    };

    // Collections Payment (Payment variant)
    const CollectionsPaymentApp = ({ theme = 'purple' }) => (
      <MicroAppCard>
        <MicroAppHeader
          icon={Icons.card}
          title="Resolve Balance"
          subtitle="Secure payment"
          theme={theme}
        />
        <ValueCard
          label="Past Due Amount"
          value="$342.18"
          subtitle="Account #****4521"
          theme={theme}
        />
        <InfoRow icon="VISA" label="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="4582" theme={theme} />
        <CTAButton theme={theme}>Pay $342.18</CTAButton>
      </MicroAppCard>
    );

    // ============================================
    // INSURANCE VARIANTS
    // ============================================

    // FNOL - First Notice of Loss (Dispute/Claim variant)
    const FNOLApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const incidents = [
        { icon: 'üöó', label: 'Auto accident' },
        { icon: 'üè†', label: 'Property damage' },
        { icon: 'üåä', label: 'Water/flood' },
        { icon: 'üî•', label: 'Fire/smoke' },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.alert}
            title="Report a Claim"
            subtitle="First Notice of Loss"
            theme={theme}
          />
          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 10, marginBottom: 20 }}>
            {incidents.map((item, i) => (
              <button key={i} style={{
                background: i === 0 ? t.accentLight : colors.gray50,
                border: i === 0 ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                borderRadius: 12, padding: '16px 12px', textAlign: 'center', cursor: 'pointer',
              }}>
                <div style={{ fontSize: 24, marginBottom: 6 }}>{item.icon}</div>
                <div style={{ fontSize: 12, fontWeight: 600, color: i === 0 ? t.accent : colors.gray700 }}>{item.label}</div>
              </button>
            ))}
          </div>
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // Premium Payment (Payment variant)
    const PremiumPaymentApp = ({ theme = 'purple' }) => (
      <MicroAppCard>
        <MicroAppHeader
          icon={Icons.card}
          title="Pay Premium"
          subtitle="Policy #POL-28491"
          theme={theme}
        />
        <ValueCard
          label="Premium Due"
          value="$186.00"
          subtitle="Monthly ‚Ä¢ Due Dec 15"
          theme={theme}
        />
        <InfoRow icon="VISA" label="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="4582" theme={theme} />
        <CTAButton theme={theme}>Pay Premium</CTAButton>
      </MicroAppCard>
    );

    // Policy Application (Form Intake variant)
    const PolicyApplicationApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.form}
            title="Policy Application"
            subtitle="Step 3 of 5"
            theme={theme}
          />
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 8, marginBottom: 24, padding: '16px 0' }}>
            {[1, 2, 3, 4, 5].map((step, i) => (
              <React.Fragment key={step}>
                <div style={{
                  width: 32, height: 32, borderRadius: '50%',
                  background: step <= 3 ? t.accent : colors.gray200,
                  color: step <= 3 ? colors.white : colors.gray400,
                  display: 'flex', alignItems: 'center', justifyContent: 'center',
                  fontSize: 13, fontWeight: 700,
                }}>{step < 3 ? '‚úì' : step}</div>
                {i < 4 && <div style={{ width: 24, height: 3, background: step < 3 ? t.accent : colors.gray200, borderRadius: 2 }} />}
              </React.Fragment>
            ))}
          </div>
          <SectionLabel theme={theme}>Coverage Details</SectionLabel>
          <SelectField label="Coverage Type" value="Comprehensive" theme={theme} />
          <InputField label="Deductible Amount" placeholder="$500" theme={theme} />
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // Insurance Consent (Signature variant)
    const InsuranceConsentApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.pen}
            title="Policy Consent"
            subtitle="E-signature required"
            theme={theme}
          />
          <div style={{ background: colors.gray50, borderRadius: 12, padding: 16, marginBottom: 16, maxHeight: 80, overflow: 'hidden', position: 'relative' }}>
            <div style={{ fontSize: 12, color: colors.gray600, lineHeight: 1.6 }}>
              I acknowledge receipt of the policy documents and agree to the terms, conditions, and exclusions outlined...
            </div>
            <div style={{ position: 'absolute', bottom: 0, left: 0, right: 0, height: 32, background: 'linear-gradient(transparent, #F9FAFB)' }} />
          </div>
          <div style={{ background: colors.white, border: `2px solid ${colors.gray200}`, borderRadius: 12, padding: 20, marginBottom: 16, minHeight: 100, position: 'relative' }}>
            <div style={{ position: 'absolute', bottom: 32, left: 20, right: 20, borderBottom: `2px solid ${colors.gray300}` }} />
            <div style={{ position: 'absolute', bottom: 28, left: 20, fontSize: 18, color: colors.gray400, fontWeight: 300 }}>‚úï</div>
            <svg width="120" height="40" viewBox="0 0 120 40" style={{ position: 'absolute', bottom: 36, left: 40 }}>
              <path d="M5 30 Q 15 5, 30 25 T 55 20 T 80 25 T 105 15" stroke={t.accent} strokeWidth="2" fill="none" opacity="0.6"/>
            </svg>
            <div style={{ position: 'absolute', bottom: 8, right: 16, fontSize: 10, color: colors.gray400 }}>Sign above</div>
          </div>
          <CTAButton theme={theme}>Accept & Sign</CTAButton>
        </MicroAppCard>
      );
    };

    // ============================================
    // HEALTHCARE VARIANTS
    // ============================================

    // Patient Intake (Form Intake variant)
    const PatientIntakeApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.form}
            title="Patient Intake"
            subtitle="Step 1 of 3"
            theme={theme}
          />
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: 8, marginBottom: 24, padding: '16px 0' }}>
            {[1, 2, 3].map((step, i) => (
              <React.Fragment key={step}>
                <div style={{
                  width: 32, height: 32, borderRadius: '50%',
                  background: step <= 1 ? t.accent : colors.gray200,
                  color: step <= 1 ? colors.white : colors.gray400,
                  display: 'flex', alignItems: 'center', justifyContent: 'center',
                  fontSize: 13, fontWeight: 700,
                }}>{step}</div>
                {i < 2 && <div style={{ width: 32, height: 3, background: colors.gray200, borderRadius: 2 }} />}
              </React.Fragment>
            ))}
          </div>
          <SectionLabel theme={theme}>Patient Information</SectionLabel>
          <InputField label="Full Name" placeholder="Enter your name" theme={theme} />
          <InputField label="Date of Birth" placeholder="MM / DD / YYYY" theme={theme} />
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // Co-Pay Payment (Payment variant)
    const CoPayApp = ({ theme = 'purple' }) => (
      <MicroAppCard>
        <MicroAppHeader
          icon={Icons.card}
          title="Pay Co-Pay"
          subtitle="Secure checkout"
          theme={theme}
        />
        <ValueCard
          label="Co-Pay Amount"
          value="$35.00"
          subtitle="Visit: Dec 5, 2024"
          theme={theme}
        />
        <InfoRow icon="VISA" label="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="4582" theme={theme} />
        <CTAButton theme={theme}>Pay $35.00</CTAButton>
      </MicroAppCard>
    );

    // Insurance Card Upload (Photo Capture variant)
    const InsuranceCardApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.camera}
            title="Insurance Card"
            subtitle="Upload front & back"
            theme={theme}
          />
          <div style={{
            border: `2px dashed ${t.accent}`, borderRadius: 16, padding: 32,
            textAlign: 'center', background: t.accentLight, marginBottom: 16,
          }}>
            <div style={{
              width: 56, height: 56, borderRadius: '50%', background: colors.white,
              display: 'flex', alignItems: 'center', justifyContent: 'center',
              margin: '0 auto 16px', boxShadow: '0 2px 8px rgba(0,0,0,0.08)',
            }}>
              <span style={{ fontSize: 24 }}>üí≥</span>
            </div>
            <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray800, marginBottom: 4 }}>
              Upload insurance card
            </div>
            <div style={{ fontSize: 12, color: colors.gray500 }}>Front side first</div>
          </div>
          <div style={{ display: 'flex', gap: 10 }}>
            <SecondaryButton theme={theme}>üì∑ Camera</SecondaryButton>
            <CTAButton theme={theme}>üìÅ Browse</CTAButton>
          </div>
        </MicroAppCard>
      );
    };

    // Treatment Consent (Signature variant)
    const TreatmentConsentApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.pen}
            title="Treatment Consent"
            subtitle="Authorization required"
            theme={theme}
          />
          <div style={{ background: colors.gray50, borderRadius: 12, padding: 16, marginBottom: 16, maxHeight: 80, overflow: 'hidden', position: 'relative' }}>
            <div style={{ fontSize: 12, color: colors.gray600, lineHeight: 1.6 }}>
              I consent to the proposed treatment plan and authorize the healthcare provider to perform the necessary procedures...
            </div>
            <div style={{ position: 'absolute', bottom: 0, left: 0, right: 0, height: 32, background: 'linear-gradient(transparent, #F9FAFB)' }} />
          </div>
          <div style={{ background: colors.white, border: `2px solid ${colors.gray200}`, borderRadius: 12, padding: 20, marginBottom: 16, minHeight: 100, position: 'relative' }}>
            <div style={{ position: 'absolute', bottom: 32, left: 20, right: 20, borderBottom: `2px solid ${colors.gray300}` }} />
            <div style={{ position: 'absolute', bottom: 28, left: 20, fontSize: 18, color: colors.gray400, fontWeight: 300 }}>‚úï</div>
            <svg width="120" height="40" viewBox="0 0 120 40" style={{ position: 'absolute', bottom: 36, left: 40 }}>
              <path d="M5 30 Q 15 5, 30 25 T 55 20 T 80 25 T 105 15" stroke={t.accent} strokeWidth="2" fill="none" opacity="0.6"/>
            </svg>
            <div style={{ position: 'absolute', bottom: 8, right: 16, fontSize: 10, color: colors.gray400 }}>Patient signature</div>
          </div>
          <CTAButton theme={theme}>I Consent</CTAButton>
        </MicroAppCard>
      );
    };

    // ============================================
    // TELECOM VARIANTS
    // ============================================

    // Device Upgrade (Service Selection variant)
    const DeviceUpgradeApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const devices = [
        { label: 'iPhone 15 Pro', desc: '$41.67/mo for 24 mo', selected: true },
        { label: 'Galaxy S24 Ultra', desc: '$37.50/mo for 24 mo', selected: false },
        { label: 'Pixel 8 Pro', desc: '$29.17/mo for 24 mo', selected: false },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.toggle}
            title="Upgrade Device"
            subtitle="You're eligible!"
            theme={theme}
          />
          <div style={{ marginBottom: 20 }}>
            {devices.map((dev, i) => (
              <div key={i} style={{
                display: 'flex', alignItems: 'center', gap: 14, padding: 16,
                background: dev.selected ? t.accentLight : colors.white,
                border: dev.selected ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                borderRadius: 12, marginBottom: 10, cursor: 'pointer',
              }}>
                <div style={{
                  width: 24, height: 24, borderRadius: '50%',
                  background: dev.selected ? t.accent : colors.white,
                  border: dev.selected ? 'none' : `2px solid ${colors.gray300}`,
                  display: 'flex', alignItems: 'center', justifyContent: 'center',
                  color: colors.white, fontSize: 14,
                }}>{dev.selected && '‚úì'}</div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray900 }}>{dev.label}</div>
                  <div style={{ fontSize: 12, color: colors.gray500, marginTop: 2 }}>{dev.desc}</div>
                </div>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // Auto-Pay Enrollment (Program Enrollment variant)
    const AutoPayApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.gift}
            title="Auto-Pay Setup"
            subtitle="Save $10/month"
            theme={theme}
          />
          <div style={{
            background: `linear-gradient(135deg, ${t.accent} 0%, ${t.accent}dd 100%)`,
            borderRadius: 16, padding: 20, marginBottom: 16, color: colors.white,
          }}>
            <div style={{ fontSize: 12, opacity: 0.8, marginBottom: 4 }}>MONTHLY SAVINGS</div>
            <div style={{ fontSize: 32, fontWeight: 800, marginBottom: 16 }}>$10/mo</div>
            <div style={{ fontSize: 12, opacity: 0.8 }}>when you enroll in Auto-Pay</div>
          </div>
          <div style={{ marginBottom: 20 }}>
            {['Automatic monthly payments', 'Never miss a due date', 'Cancel anytime'].map((benefit, i) => (
              <div key={i} style={{ display: 'flex', alignItems: 'center', gap: 10, padding: '10px 0', borderBottom: i < 2 ? `1px solid ${colors.gray100}` : 'none' }}>
                <div style={{ width: 20, height: 20, borderRadius: '50%', background: t.accentLight, color: t.accent, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: 11 }}>‚úì</div>
                <span style={{ fontSize: 14, color: colors.gray700 }}>{benefit}</span>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Enroll in Auto-Pay</CTAButton>
        </MicroAppCard>
      );
    };

    // Account Update (ID + Form variant)
    const AccountUpdateApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const updates = [
        { icon: 'üìç', label: 'Change address', selected: true },
        { icon: 'üë§', label: 'Update name', selected: false },
        { icon: '‚ûï', label: 'Add authorized user', selected: false },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.user}
            title="Update Account"
            subtitle="What would you like to change?"
            theme={theme}
          />
          <div style={{ marginBottom: 20 }}>
            {updates.map((item, i) => (
              <div key={i} style={{
                display: 'flex', alignItems: 'center', gap: 14, padding: 16,
                background: item.selected ? t.accentLight : colors.white,
                border: item.selected ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                borderRadius: 12, marginBottom: 10, cursor: 'pointer',
              }}>
                <div style={{ fontSize: 20 }}>{item.icon}</div>
                <div style={{ flex: 1, fontSize: 14, fontWeight: 600, color: colors.gray900 }}>{item.label}</div>
                <div style={{
                  width: 22, height: 22, borderRadius: '50%',
                  background: item.selected ? t.accent : colors.white,
                  border: item.selected ? 'none' : `2px solid ${colors.gray300}`,
                  display: 'flex', alignItems: 'center', justifyContent: 'center',
                  color: colors.white, fontSize: 12,
                }}>{item.selected && '‚úì'}</div>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // New Line Activation (Service + Consent)
    const NewLineApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.toggle}
            title="Activate New Line"
            subtitle="Add to your plan"
            theme={theme}
          />
          <SectionLabel theme={theme}>Line Details</SectionLabel>
          <InputField label="Phone Number" placeholder="(555) 123-4567" theme={theme} />
          <SelectField label="Plan Type" value="Unlimited Premium" theme={theme} />
          <div style={{ display: 'flex', alignItems: 'flex-start', gap: 10, padding: 12, background: colors.gray50, borderRadius: 10, marginBottom: 16 }}>
            <input type="checkbox" defaultChecked style={{ marginTop: 2, accentColor: t.accent }} />
            <span style={{ fontSize: 12, color: colors.gray600, lineHeight: 1.5 }}>
              I agree to the Terms of Service and authorize credit verification
            </span>
          </div>
          <CTAButton theme={theme}>Activate Line</CTAButton>
        </MicroAppCard>
      );
    };

    // ============================================
    // UTILITIES VARIANTS
    // ============================================

    // Service Transfer (Service Selection variant)
    const ServiceTransferApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const options = [
        { label: 'Start new service', desc: 'At a new address', selected: false },
        { label: 'Stop service', desc: 'Cancel current plan', selected: false },
        { label: 'Transfer service', desc: 'Moving to new home', selected: true },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.toggle}
            title="Service Request"
            subtitle="Manage your utility service"
            theme={theme}
          />
          <div style={{ marginBottom: 20 }}>
            {options.map((opt, i) => (
              <div key={i} style={{
                display: 'flex', alignItems: 'center', gap: 14, padding: 16,
                background: opt.selected ? t.accentLight : colors.white,
                border: opt.selected ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                borderRadius: 12, marginBottom: 10, cursor: 'pointer',
              }}>
                <div style={{
                  width: 24, height: 24, borderRadius: '50%',
                  background: opt.selected ? t.accent : colors.white,
                  border: opt.selected ? 'none' : `2px solid ${colors.gray300}`,
                  display: 'flex', alignItems: 'center', justifyContent: 'center',
                  color: colors.white, fontSize: 14,
                }}>{opt.selected && '‚úì'}</div>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray900 }}>{opt.label}</div>
                  <div style={{ fontSize: 12, color: colors.gray500, marginTop: 2 }}>{opt.desc}</div>
                </div>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // Meter Reading (Photo Capture variant)
    const MeterReadingApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.camera}
            title="Meter Reading"
            subtitle="Submit your reading"
            theme={theme}
          />
          <div style={{
            border: `2px dashed ${t.accent}`, borderRadius: 16, padding: 32,
            textAlign: 'center', background: t.accentLight, marginBottom: 16,
          }}>
            <div style={{
              width: 56, height: 56, borderRadius: '50%', background: colors.white,
              display: 'flex', alignItems: 'center', justifyContent: 'center',
              margin: '0 auto 16px', boxShadow: '0 2px 8px rgba(0,0,0,0.08)',
            }}>
              <span style={{ fontSize: 24 }}>üìä</span>
            </div>
            <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray800, marginBottom: 4 }}>
              Photo your meter
            </div>
            <div style={{ fontSize: 12, color: colors.gray500 }}>Make sure numbers are visible</div>
          </div>
          <InputField label="Or enter reading manually" placeholder="00000.00" theme={theme} />
          <CTAButton theme={theme}>Submit Reading</CTAButton>
        </MicroAppCard>
      );
    };

    // Budget Billing (Program Enrollment variant)
    const BudgetBillingApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.gift}
            title="Budget Billing"
            subtitle="Predictable monthly bills"
            theme={theme}
          />
          <div style={{
            background: `linear-gradient(135deg, ${t.accent} 0%, ${t.accent}dd 100%)`,
            borderRadius: 16, padding: 20, marginBottom: 16, color: colors.white,
          }}>
            <div style={{ fontSize: 12, opacity: 0.8, marginBottom: 4 }}>ESTIMATED MONTHLY</div>
            <div style={{ fontSize: 32, fontWeight: 800, marginBottom: 16 }}>$142/mo</div>
            <div style={{ fontSize: 12, opacity: 0.8 }}>Based on 12-month average</div>
          </div>
          <div style={{ marginBottom: 20 }}>
            {['Same amount every month', 'No surprise bills', 'Annual true-up adjustment'].map((benefit, i) => (
              <div key={i} style={{ display: 'flex', alignItems: 'center', gap: 10, padding: '10px 0', borderBottom: i < 2 ? `1px solid ${colors.gray100}` : 'none' }}>
                <div style={{ width: 20, height: 20, borderRadius: '50%', background: t.accentLight, color: t.accent, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: 11 }}>‚úì</div>
                <span style={{ fontSize: 14, color: colors.gray700 }}>{benefit}</span>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Enroll Now</CTAButton>
        </MicroAppCard>
      );
    };

    // Utility Bill Payment (Payment variant)
    const UtilityPaymentApp = ({ theme = 'purple' }) => (
      <MicroAppCard>
        <MicroAppHeader
          icon={Icons.card}
          title="Pay Utility Bill"
          subtitle="Account #****7832"
          theme={theme}
        />
        <ValueCard
          label="Current Balance"
          value="$156.43"
          subtitle="Due Dec 20"
          theme={theme}
        />
        <InfoRow icon="VISA" label="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="4582" theme={theme} />
        <CTAButton theme={theme}>Pay $156.43</CTAButton>
      </MicroAppCard>
    );

    // ============================================
    // TRAVEL VARIANTS
    // ============================================

    // Booking Modification (Service Selection variant)
    const BookingModApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const options = [
        { icon: 'üìÖ', label: 'Change dates', selected: true },
        { icon: '‚úàÔ∏è', label: 'Change flight', selected: false },
        { icon: '‚ùå', label: 'Cancel booking', selected: false },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.plane}
            title="Modify Booking"
            subtitle="Confirmation #ABC123"
            theme={theme}
          />
          <div style={{ marginBottom: 20 }}>
            {options.map((opt, i) => (
              <div key={i} style={{
                display: 'flex', alignItems: 'center', gap: 14, padding: 16,
                background: opt.selected ? t.accentLight : colors.white,
                border: opt.selected ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                borderRadius: 12, marginBottom: 10, cursor: 'pointer',
              }}>
                <div style={{ fontSize: 20 }}>{opt.icon}</div>
                <div style={{ flex: 1, fontSize: 14, fontWeight: 600, color: colors.gray900 }}>{opt.label}</div>
                <div style={{
                  width: 22, height: 22, borderRadius: '50%',
                  background: opt.selected ? t.accent : colors.white,
                  border: opt.selected ? 'none' : `2px solid ${colors.gray300}`,
                  display: 'flex', alignItems: 'center', justifyContent: 'center',
                  color: colors.white, fontSize: 12,
                }}>{opt.selected && '‚úì'}</div>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // Travel Payment (Payment variant with trip info)
    const TravelPaymentApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.plane}
            title="Complete Payment"
            subtitle="Secure checkout"
            theme={theme}
          />
          <div style={{ background: colors.gray50, borderRadius: 12, padding: 16, marginBottom: 16 }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
              <div>
                <div style={{ fontSize: 11, color: colors.gray500 }}>ROUNDTRIP</div>
                <div style={{ fontSize: 15, fontWeight: 700, color: colors.gray900 }}>LAX ‚Üí MIA</div>
              </div>
              <div style={{ textAlign: 'right' }}>
                <div style={{ fontSize: 11, color: colors.gray500 }}>DATES</div>
                <div style={{ fontSize: 13, fontWeight: 600, color: colors.gray800 }}>Dec 20 - 27</div>
              </div>
            </div>
          </div>
          <ValueCard label="Total Due" value="$623.00" subtitle="2 passengers" theme={theme} />
          <InfoRow icon="VISA" label="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="4582" theme={theme} />
          <CTAButton theme={theme}>Pay & Confirm</CTAButton>
        </MicroAppCard>
      );
    };

    // Loyalty Redemption (Travel)
    const LoyaltyRedemptionApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.gift}
            title="Redeem Miles"
            subtitle="Use your rewards"
            theme={theme}
          />
          <div style={{
            background: `linear-gradient(135deg, ${t.accent} 0%, ${t.accent}dd 100%)`,
            borderRadius: 16, padding: 20, marginBottom: 16, color: colors.white,
          }}>
            <div style={{ fontSize: 12, opacity: 0.8, marginBottom: 4 }}>AVAILABLE MILES</div>
            <div style={{ fontSize: 32, fontWeight: 800, marginBottom: 8 }}>47,500</div>
            <div style={{ fontSize: 12, opacity: 0.8 }}>Gold Member ‚Ä¢ Expires Dec 2025</div>
          </div>
          <SectionLabel theme={theme}>Redemption Options</SectionLabel>
          <div style={{ marginBottom: 16 }}>
            {[
              { miles: '25,000', value: 'One-way domestic flight' },
              { miles: '45,000', value: 'Round-trip domestic' },
            ].map((opt, i) => (
              <div key={i} style={{
                display: 'flex', justifyContent: 'space-between', alignItems: 'center',
                padding: '12px 0', borderBottom: i === 0 ? `1px solid ${colors.gray100}` : 'none',
              }}>
                <span style={{ fontSize: 14, color: colors.gray700 }}>{opt.value}</span>
                <span style={{ fontSize: 14, fontWeight: 700, color: t.accent }}>{opt.miles}</span>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>Redeem Now</CTAButton>
        </MicroAppCard>
      );
    };

    // Check-In (Travel)
    const CheckInApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.plane}
            title="Check In"
            subtitle="Flight UA 1234"
            theme={theme}
          />
          <div style={{ background: colors.gray50, borderRadius: 12, padding: 16, marginBottom: 16 }}>
            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 12 }}>
              <div>
                <div style={{ fontSize: 24, fontWeight: 800, color: colors.gray900 }}>SFO</div>
                <div style={{ fontSize: 11, color: colors.gray500 }}>San Francisco</div>
              </div>
              <div style={{ color: t.accent, fontSize: 20 }}>‚Üí</div>
              <div style={{ textAlign: 'right' }}>
                <div style={{ fontSize: 24, fontWeight: 800, color: colors.gray900 }}>LAX</div>
                <div style={{ fontSize: 11, color: colors.gray500 }}>Los Angeles</div>
              </div>
            </div>
            <div style={{ borderTop: `1px solid ${colors.gray200}`, paddingTop: 12 }}>
              <div style={{ fontSize: 12, color: colors.gray500 }}>DEPARTURE</div>
              <div style={{ fontSize: 15, fontWeight: 600, color: colors.gray800 }}>Today, 3:45 PM ‚Ä¢ Gate B12</div>
            </div>
          </div>
          <InputField label="Seat Preference" placeholder="Window selected" theme={theme} />
          <CTAButton theme={theme}>Complete Check-In</CTAButton>
        </MicroAppCard>
      );
    };

    // ============================================
    // RETAIL / E-COMMERCE VARIANTS
    // ============================================

    // Order Return (Dispute variant)
    const OrderReturnApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const reasons = [
        { icon: 'üì¶', label: 'Wrong item received' },
        { icon: 'üíî', label: 'Item damaged' },
        { icon: 'üîÑ', label: 'Changed my mind' },
        { icon: 'üìè', label: 'Size/fit issue' },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.receipt}
            title="Return Item"
            subtitle="Order #ORD-78432"
            theme={theme}
          />
          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: 10, marginBottom: 20 }}>
            {reasons.map((item, i) => (
              <button key={i} style={{
                background: i === 1 ? t.accentLight : colors.gray50,
                border: i === 1 ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                borderRadius: 12, padding: '16px 12px', textAlign: 'center', cursor: 'pointer',
              }}>
                <div style={{ fontSize: 24, marginBottom: 6 }}>{item.icon}</div>
                <div style={{ fontSize: 12, fontWeight: 600, color: i === 1 ? t.accent : colors.gray700 }}>{item.label}</div>
              </button>
            ))}
          </div>
          <CTAButton theme={theme}>Start Return</CTAButton>
        </MicroAppCard>
      );
    };

    // Order Tracking
    const OrderTrackingApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      const steps = [
        { label: 'Order placed', date: 'Dec 1', done: true },
        { label: 'Shipped', date: 'Dec 3', done: true },
        { label: 'Out for delivery', date: 'Dec 5', done: true },
        { label: 'Delivered', date: 'Today', done: false },
      ];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.receipt}
            title="Track Order"
            subtitle="Order #ORD-78432"
            theme={theme}
          />
          <div style={{ marginBottom: 20 }}>
            {steps.map((step, i) => (
              <div key={i} style={{ display: 'flex', gap: 14, marginBottom: i < steps.length - 1 ? 0 : 0 }}>
                <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: 20 }}>
                  <div style={{
                    width: 14, height: 14, borderRadius: '50%',
                    background: step.done ? t.accent : colors.white,
                    border: step.done ? 'none' : `2px solid ${colors.gray300}`,
                  }} />
                  {i < steps.length - 1 && (
                    <div style={{ width: 2, height: 32, background: step.done ? t.accent : colors.gray200 }} />
                  )}
                </div>
                <div style={{ flex: 1, paddingBottom: 16 }}>
                  <div style={{ fontSize: 14, fontWeight: 600, color: step.done ? colors.gray900 : colors.gray400 }}>{step.label}</div>
                  <div style={{ fontSize: 12, color: colors.gray500, marginTop: 2 }}>{step.date}</div>
                </div>
              </div>
            ))}
          </div>
          <SecondaryButton theme={theme}>View Details</SecondaryButton>
        </MicroAppCard>
      );
    };

    // Loyalty Enrollment (Retail)
    const RetailLoyaltyApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.gift}
            title="Join Rewards"
            subtitle="Start earning today"
            theme={theme}
          />
          <div style={{
            background: `linear-gradient(135deg, ${t.accent} 0%, ${t.accent}dd 100%)`,
            borderRadius: 16, padding: 20, marginBottom: 16, color: colors.white,
          }}>
            <div style={{ fontSize: 12, opacity: 0.8, marginBottom: 4 }}>WELCOME BONUS</div>
            <div style={{ fontSize: 32, fontWeight: 800, marginBottom: 8 }}>500 pts</div>
            <div style={{ fontSize: 12, opacity: 0.8 }}>= $5 off your next purchase</div>
          </div>
          <div style={{ marginBottom: 20 }}>
            {['Earn 1 pt per $1 spent', 'Birthday rewards', 'Exclusive member deals'].map((benefit, i) => (
              <div key={i} style={{ display: 'flex', alignItems: 'center', gap: 10, padding: '10px 0', borderBottom: i < 2 ? `1px solid ${colors.gray100}` : 'none' }}>
                <div style={{ width: 20, height: 20, borderRadius: '50%', background: t.accentLight, color: t.accent, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: 11 }}>‚úì</div>
                <span style={{ fontSize: 14, color: colors.gray700 }}>{benefit}</span>
              </div>
            ))}
          </div>
          <InputField label="Email Address" placeholder="you@email.com" theme={theme} />
          <CTAButton theme={theme}>Join Now</CTAButton>
        </MicroAppCard>
      );
    };

    // Gift Card Balance
    const GiftCardApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.gift}
            title="Gift Card"
            subtitle="Check balance & redeem"
            theme={theme}
          />
          <ValueCard
            label="Available Balance"
            value="$75.00"
            subtitle="Card ending ****8821"
            theme={theme}
          />
          <SectionLabel theme={theme}>Quick Actions</SectionLabel>
          <div style={{ display: 'flex', gap: 10, marginBottom: 16 }}>
            <button style={{
              flex: 1, padding: '14px 16px', borderRadius: 12,
              background: t.accentLight, border: 'none',
              fontSize: 13, fontWeight: 600, color: t.accent, cursor: 'pointer',
            }}>
              Add Funds
            </button>
            <button style={{
              flex: 1, padding: '14px 16px', borderRadius: 12,
              background: colors.gray100, border: 'none',
              fontSize: 13, fontWeight: 600, color: colors.gray700, cursor: 'pointer',
            }}>
              View History
            </button>
          </div>
          <CTAButton theme={theme}>Apply to Order</CTAButton>
        </MicroAppCard>
      );
    };

    // ============================================
    // FINANCIAL (Additional)
    // ============================================

    // Fund Transfer
    const FundTransferApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.card}
            title="Transfer Funds"
            subtitle="Move money securely"
            theme={theme}
          />
          <SectionLabel theme={theme}>From Account</SectionLabel>
          <SelectField value="Checking ****4521 ‚Ä¢ $4,230.50" theme={theme} />
          <SectionLabel theme={theme}>To Account</SectionLabel>
          <SelectField value="Savings ****8832 ‚Ä¢ $12,450.00" theme={theme} />
          <InputField label="Amount" placeholder="$0.00" theme={theme} />
          <CTAButton theme={theme}>Transfer Now</CTAButton>
        </MicroAppCard>
      );
    };

    // ============================================
    // CROSS-INDUSTRY / UNIVERSAL
    // ============================================

    // PIN Reset
    const PINResetApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.shield}
            title="Reset PIN"
            subtitle="Secure verification"
            theme={theme}
          />
          <div style={{
            background: t.accentLight,
            borderRadius: 12,
            padding: 16,
            marginBottom: 16,
            display: 'flex',
            alignItems: 'center',
            gap: 12,
          }}>
            <div style={{ fontSize: 24 }}>üîí</div>
            <div style={{ fontSize: 13, color: colors.gray700, lineHeight: 1.5 }}>
              For your security, we'll verify your identity before resetting your PIN.
            </div>
          </div>
          <InputField label="Last 4 of SSN" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" theme={theme} />
          <InputField label="Date of Birth" placeholder="MM / DD / YYYY" theme={theme} />
          <CTAButton theme={theme}>Verify & Continue</CTAButton>
        </MicroAppCard>
      );
    };

    // Billing Statement
    const BillingStatementApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.receipt}
            title="Billing Statement"
            subtitle="December 2024"
            theme={theme}
          />
          <ValueCard
            label="Current Balance"
            value="$284.50"
            subtitle="Due Dec 15"
            theme={theme}
          />
          <div style={{ marginBottom: 16 }}>
            {[
              { label: 'Previous balance', amount: '$0.00' },
              { label: 'New charges', amount: '$284.50' },
              { label: 'Payments received', amount: '-$0.00' },
            ].map((item, i) => (
              <div key={i} style={{
                display: 'flex', justifyContent: 'space-between',
                padding: '10px 0', borderBottom: i < 2 ? `1px solid ${colors.gray100}` : 'none',
              }}>
                <span style={{ fontSize: 14, color: colors.gray600 }}>{item.label}</span>
                <span style={{ fontSize: 14, fontWeight: 600, color: colors.gray900 }}>{item.amount}</span>
              </div>
            ))}
          </div>
          <div style={{ display: 'flex', gap: 10 }}>
            <SecondaryButton theme={theme}>Download PDF</SecondaryButton>
            <CTAButton theme={theme}>Pay Now</CTAButton>
          </div>
        </MicroAppCard>
      );
    };

    // Account Preferences
    const AccountPrefsApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.user}
            title="Account Settings"
            subtitle="Manage preferences"
            theme={theme}
          />
          <SectionLabel theme={theme}>Notifications</SectionLabel>
          {[
            { label: 'Email notifications', on: true },
            { label: 'SMS alerts', on: true },
            { label: 'Marketing emails', on: false },
          ].map((pref, i) => (
            <div key={i} style={{
              display: 'flex', justifyContent: 'space-between', alignItems: 'center',
              padding: '12px 0', borderBottom: i < 2 ? `1px solid ${colors.gray100}` : 'none',
            }}>
              <span style={{ fontSize: 14, color: colors.gray700 }}>{pref.label}</span>
              <div style={{
                width: 44, height: 24, borderRadius: 12,
                background: pref.on ? t.accent : colors.gray300,
                position: 'relative', cursor: 'pointer',
              }}>
                <div style={{
                  width: 20, height: 20, borderRadius: '50%', background: colors.white,
                  position: 'absolute', top: 2,
                  left: pref.on ? 22 : 2,
                  boxShadow: '0 1px 3px rgba(0,0,0,0.2)',
                }} />
              </div>
            </div>
          ))}
          <div style={{ marginTop: 16 }}>
            <CTAButton theme={theme}>Save Preferences</CTAButton>
          </div>
        </MicroAppCard>
      );
    };

    // Pure E-Signature
    const ESignatureApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.pen}
            title="Sign Document"
            subtitle="1 signature required"
            theme={theme}
          />
          <div style={{
            background: colors.gray50, borderRadius: 12, padding: 16, marginBottom: 16,
          }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: 12, marginBottom: 8 }}>
              <span style={{ fontSize: 20 }}>üìÑ</span>
              <div>
                <div style={{ fontSize: 14, fontWeight: 600, color: colors.gray900 }}>Service Agreement</div>
                <div style={{ fontSize: 12, color: colors.gray500 }}>PDF ‚Ä¢ 3 pages</div>
              </div>
            </div>
            <button style={{
              width: '100%', padding: '8px 12px', borderRadius: 8,
              background: colors.white, border: `1px solid ${colors.gray200}`,
              fontSize: 12, color: t.accent, fontWeight: 600, cursor: 'pointer',
            }}>
              View Document
            </button>
          </div>
          <div style={{ background: colors.white, border: `2px solid ${colors.gray200}`, borderRadius: 12, padding: 20, marginBottom: 16, minHeight: 100, position: 'relative' }}>
            <div style={{ position: 'absolute', bottom: 32, left: 20, right: 20, borderBottom: `2px solid ${colors.gray300}` }} />
            <div style={{ position: 'absolute', bottom: 28, left: 20, fontSize: 18, color: colors.gray400, fontWeight: 300 }}>‚úï</div>
            <svg width="120" height="40" viewBox="0 0 120 40" style={{ position: 'absolute', bottom: 36, left: 40 }}>
              <path d="M5 30 Q 15 5, 30 25 T 55 20 T 80 25 T 105 15" stroke={t.accent} strokeWidth="2" fill="none" opacity="0.6"/>
            </svg>
            <div style={{ position: 'absolute', bottom: 8, right: 16, fontSize: 10, color: colors.gray400 }}>Sign here</div>
          </div>
          <CTAButton theme={theme}>Sign & Submit</CTAButton>
        </MicroAppCard>
      );
    };

    // Compliance / Terms Acceptance
    const ComplianceApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.shield}
            title="Terms & Conditions"
            subtitle="Annual acknowledgment"
            theme={theme}
          />
          <div style={{
            background: colors.gray50, borderRadius: 12, padding: 16, marginBottom: 16,
            maxHeight: 120, overflow: 'hidden', position: 'relative',
          }}>
            <div style={{ fontSize: 12, color: colors.gray600, lineHeight: 1.7 }}>
              By continuing, you acknowledge that you have read, understood, and agree to be bound by our updated Terms of Service and Privacy Policy. These terms govern your use of our services and outline your rights and responsibilities...
            </div>
            <div style={{ position: 'absolute', bottom: 0, left: 0, right: 0, height: 40, background: 'linear-gradient(transparent, #F9FAFB)' }} />
          </div>
          <div style={{ marginBottom: 16 }}>
            {[
              { label: 'Terms of Service', checked: true },
              { label: 'Privacy Policy', checked: true },
              { label: 'Electronic Communications', checked: false },
            ].map((item, i) => (
              <div key={i} style={{ display: 'flex', alignItems: 'center', gap: 10, padding: '10px 0' }}>
                <input type="checkbox" defaultChecked={item.checked} style={{ accentColor: t.accent, width: 18, height: 18 }} />
                <span style={{ fontSize: 14, color: colors.gray700 }}>{item.label}</span>
              </div>
            ))}
          </div>
          <CTAButton theme={theme}>I Accept</CTAButton>
        </MicroAppCard>
      );
    };

    // Contact Update
    const ContactUpdateApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.user}
            title="Update Contact Info"
            subtitle="Keep your details current"
            theme={theme}
          />
          <SectionLabel theme={theme}>Contact Information</SectionLabel>
          <InputField label="Email Address" placeholder="john@email.com" theme={theme} />
          <InputField label="Phone Number" placeholder="(555) 123-4567" theme={theme} />
          <InputField label="Mailing Address" placeholder="123 Main St, City, ST 12345" theme={theme} />
          <CTAButton theme={theme}>Save Changes</CTAButton>
        </MicroAppCard>
      );
    };

    // Feedback / Survey
    const FeedbackApp = ({ theme = 'purple' }) => {
      const t = themes[theme];
      return (
        <MicroAppCard>
          <MicroAppHeader
            icon={Icons.form}
            title="Share Feedback"
            subtitle="Help us improve"
            theme={theme}
          />
          <SectionLabel theme={theme}>How was your experience?</SectionLabel>
          <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 20, padding: '8px 0' }}>
            {['üòû', 'üòê', 'üôÇ', 'üòä', 'ü§©'].map((emoji, i) => (
              <button key={i} style={{
                width: 48, height: 48, borderRadius: 12,
                background: i === 3 ? t.accentLight : colors.gray50,
                border: i === 3 ? `2px solid ${t.accent}` : `1px solid ${colors.gray200}`,
                fontSize: 24, cursor: 'pointer',
                display: 'flex', alignItems: 'center', justifyContent: 'center',
              }}>
                {emoji}
              </button>
            ))}
          </div>
          <InputField label="Comments (optional)" placeholder="Tell us more..." theme={theme} />
          <CTAButton theme={theme}>Submit Feedback</CTAButton>
        </MicroAppCard>
      );
    };

    // ============================================
    // THEME PICKER
    // ============================================
    const ThemePicker = ({ currentTheme, onSelect }) => (
      <div style={{ marginBottom: 24 }}>
        <div style={{
          fontSize: 11,
          fontWeight: 700,
          color: colors.gray500,
          textTransform: 'uppercase',
          letterSpacing: 1.2,
          marginBottom: 12,
        }}>
          Theme
        </div>
        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: 10 }}>
          {Object.entries(themes).map(([key, t]) => (
            <button
              key={key}
              onClick={() => onSelect(key)}
              style={{
                width: 64,
                height: 64,
                borderRadius: 12,
                background: t.accentLight,
                border: currentTheme === key ? `3px solid ${colors.gray900}` : '3px solid transparent',
                cursor: 'pointer',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
              }}
            >
              <div style={{
                width: 24,
                height: 24,
                borderRadius: 6,
                background: t.accent,
              }} />
            </button>
          ))}
        </div>
      </div>
    );

    // ============================================
    // MAIN APP
    // ============================================
    function App() {
      const [currentTheme, setCurrentTheme] = useState('purple');
      const [activeApp, setActiveApp] = useState('payment');
      const [exporting, setExporting] = useState(false);
      const appRef = useRef(null);

      const apps = [
        // Core Patterns
        { id: 'payment', label: 'Payment', category: 'Core' },
        { id: 'identity', label: 'ID Verify', category: 'Core' },
        { id: 'form', label: 'Form Intake', category: 'Core' },
        { id: 'dispute', label: 'Dispute', category: 'Core' },
        { id: 'photo', label: 'Photo Upload', category: 'Core' },
        { id: 'signature', label: 'Signature', category: 'Core' },
        { id: 'service', label: 'Service Select', category: 'Core' },
        { id: 'program', label: 'Enrollment', category: 'Core' },
        { id: 'booking', label: 'Booking', category: 'Core' },
        { id: 'arrangement', label: 'Pay Plan', category: 'Core' },
        // Financial Services
        { id: 'newaccount', label: 'New Account', category: 'Financial' },
        { id: 'kyc', label: 'KYC Refresh', category: 'Financial' },
        { id: 'collections', label: 'Collections', category: 'Financial' },
        { id: 'fundtransfer', label: 'Fund Transfer', category: 'Financial' },
        // Insurance
        { id: 'fnol', label: 'FNOL Claim', category: 'Insurance' },
        { id: 'premium', label: 'Premium Payment', category: 'Insurance' },
        { id: 'policyapp', label: 'Policy App', category: 'Insurance' },
        { id: 'insuranceconsent', label: 'Policy Consent', category: 'Insurance' },
        // Healthcare
        { id: 'patientintake', label: 'Patient Intake', category: 'Healthcare' },
        { id: 'copay', label: 'Co-Pay', category: 'Healthcare' },
        { id: 'insurancecard', label: 'Insurance Card', category: 'Healthcare' },
        { id: 'treatmentconsent', label: 'Treatment Consent', category: 'Healthcare' },
        // Telecom
        { id: 'deviceupgrade', label: 'Device Upgrade', category: 'Telecom' },
        { id: 'autopay', label: 'Auto-Pay', category: 'Telecom' },
        { id: 'accountupdate', label: 'Account Update', category: 'Telecom' },
        { id: 'newline', label: 'New Line', category: 'Telecom' },
        // Utilities
        { id: 'servicetransfer', label: 'Service Transfer', category: 'Utilities' },
        { id: 'meterreading', label: 'Meter Reading', category: 'Utilities' },
        { id: 'budgetbilling', label: 'Budget Billing', category: 'Utilities' },
        { id: 'utilitypayment', label: 'Utility Payment', category: 'Utilities' },
        // Travel
        { id: 'bookingmod', label: 'Modify Booking', category: 'Travel' },
        { id: 'travelpayment', label: 'Travel Payment', category: 'Travel' },
        { id: 'loyaltyredeem', label: 'Redeem Miles', category: 'Travel' },
        { id: 'checkin', label: 'Check-In', category: 'Travel' },
        // Retail / E-commerce
        { id: 'orderreturn', label: 'Order Return', category: 'Retail' },
        { id: 'ordertracking', label: 'Order Tracking', category: 'Retail' },
        { id: 'retailloyalty', label: 'Join Rewards', category: 'Retail' },
        { id: 'giftcard', label: 'Gift Card', category: 'Retail' },
        // Cross-Industry / Universal
        { id: 'pinreset', label: 'PIN Reset', category: 'Universal' },
        { id: 'billing', label: 'Billing Statement', category: 'Universal' },
        { id: 'accountprefs', label: 'Account Settings', category: 'Universal' },
        { id: 'esignature', label: 'E-Signature', category: 'Universal' },
        { id: 'compliance', label: 'Terms & Compliance', category: 'Universal' },
        { id: 'contactupdate', label: 'Contact Update', category: 'Universal' },
        { id: 'feedback', label: 'Feedback', category: 'Universal' },
      ];

      const categories = ['Core', 'Financial', 'Insurance', 'Healthcare', 'Telecom', 'Utilities', 'Travel', 'Retail', 'Universal'];
      const [activeCategory, setActiveCategory] = useState('all');

      const filteredApps = activeCategory === 'all' 
        ? apps 
        : apps.filter(app => app.category === activeCategory);

      const [selectedForExport, setSelectedForExport] = useState({});
      const galleryRefs = useRef({});

      const toggleExportSelection = (id) => {
        setSelectedForExport(prev => ({
          ...prev,
          [id]: !prev[id]
        }));
      };

      const selectAll = () => {
        const allSelected = {};
        filteredApps.forEach(app => { allSelected[app.id] = true; });
        setSelectedForExport(allSelected);
      };

      const selectNone = () => {
        setSelectedForExport({});
      };

      const selectedCount = Object.values(selectedForExport).filter(Boolean).length;

      const exportToPNG = async () => {
        if (!appRef.current) return;
        setExporting(true);
        try {
          const canvas = await html2canvas(appRef.current, {
            backgroundColor: null,
            scale: 2,
            logging: false,
            useCORS: true,
          });
          const link = document.createElement('a');
          link.download = `${activeApp}-${currentTheme}.png`;
          link.href = canvas.toDataURL('image/png');
          link.click();
        } catch (err) {
          console.error('Export failed:', err);
        }
        setExporting(false);
      };

      const exportSelected = async () => {
        const selectedIds = Object.entries(selectedForExport)
          .filter(([_, selected]) => selected)
          .map(([id]) => id);
        
        if (selectedIds.length === 0) return;
        
        setExporting(true);
        
        for (const id of selectedIds) {
          const ref = galleryRefs.current[id];
          if (!ref) continue;
          
          try {
            const canvas = await html2canvas(ref, {
              backgroundColor: null,
              scale: 2,
              logging: false,
              useCORS: true,
            });
            const link = document.createElement('a');
            link.download = `${id}-${currentTheme}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
            // Small delay between downloads
            await new Promise(resolve => setTimeout(resolve, 300));
          } catch (err) {
            console.error(`Export failed for ${id}:`, err);
          }
        }
        
        setExporting(false);
      };

      const renderAppById = (id) => {
        switch(id) {
          // Core patterns
          case 'payment': return <MakePaymentApp theme={currentTheme} />;
          case 'identity': return <IDVerificationApp theme={currentTheme} />;
          case 'form': return <FormIntakeApp theme={currentTheme} />;
          case 'dispute': return <DisputeClaimApp theme={currentTheme} />;
          case 'photo': return <PhotoCaptureApp theme={currentTheme} />;
          case 'signature': return <SignatureApp theme={currentTheme} />;
          case 'service': return <ServiceSelectionApp theme={currentTheme} />;
          case 'program': return <ProgramEnrollmentApp theme={currentTheme} />;
          case 'booking': return <BookingItineraryApp theme={currentTheme} />;
          case 'arrangement': return <PaymentArrangementApp theme={currentTheme} />;
          // Financial
          case 'newaccount': return <OpenAccountApp theme={currentTheme} />;
          case 'kyc': return <KYCRefreshApp theme={currentTheme} />;
          case 'collections': return <CollectionsPaymentApp theme={currentTheme} />;
          case 'fundtransfer': return <FundTransferApp theme={currentTheme} />;
          // Insurance
          case 'fnol': return <FNOLApp theme={currentTheme} />;
          case 'premium': return <PremiumPaymentApp theme={currentTheme} />;
          case 'policyapp': return <PolicyApplicationApp theme={currentTheme} />;
          case 'insuranceconsent': return <InsuranceConsentApp theme={currentTheme} />;
          // Healthcare
          case 'patientintake': return <PatientIntakeApp theme={currentTheme} />;
          case 'copay': return <CoPayApp theme={currentTheme} />;
          case 'insurancecard': return <InsuranceCardApp theme={currentTheme} />;
          case 'treatmentconsent': return <TreatmentConsentApp theme={currentTheme} />;
          // Telecom
          case 'deviceupgrade': return <DeviceUpgradeApp theme={currentTheme} />;
          case 'autopay': return <AutoPayApp theme={currentTheme} />;
          case 'accountupdate': return <AccountUpdateApp theme={currentTheme} />;
          case 'newline': return <NewLineApp theme={currentTheme} />;
          // Utilities
          case 'servicetransfer': return <ServiceTransferApp theme={currentTheme} />;
          case 'meterreading': return <MeterReadingApp theme={currentTheme} />;
          case 'budgetbilling': return <BudgetBillingApp theme={currentTheme} />;
          case 'utilitypayment': return <UtilityPaymentApp theme={currentTheme} />;
          // Travel
          case 'bookingmod': return <BookingModApp theme={currentTheme} />;
          case 'travelpayment': return <TravelPaymentApp theme={currentTheme} />;
          case 'loyaltyredeem': return <LoyaltyRedemptionApp theme={currentTheme} />;
          case 'checkin': return <CheckInApp theme={currentTheme} />;
          // Retail
          case 'orderreturn': return <OrderReturnApp theme={currentTheme} />;
          case 'ordertracking': return <OrderTrackingApp theme={currentTheme} />;
          case 'retailloyalty': return <RetailLoyaltyApp theme={currentTheme} />;
          case 'giftcard': return <GiftCardApp theme={currentTheme} />;
          // Universal / Cross-Industry
          case 'pinreset': return <PINResetApp theme={currentTheme} />;
          case 'billing': return <BillingStatementApp theme={currentTheme} />;
          case 'accountprefs': return <AccountPrefsApp theme={currentTheme} />;
          case 'esignature': return <ESignatureApp theme={currentTheme} />;
          case 'compliance': return <ComplianceApp theme={currentTheme} />;
          case 'contactupdate': return <ContactUpdateApp theme={currentTheme} />;
          case 'feedback': return <FeedbackApp theme={currentTheme} />;
          default: return null;
        }
      };

      const renderApp = () => renderAppById(activeApp);

      const isGalleryView = activeApp === 'gallery';

      return (
        <div style={{
          minHeight: '100vh',
          background: 'linear-gradient(135deg, #f0f4f8 0%, #e2e8f0 100%)',
        }}>
          {/* Control Bar */}
          <div style={{
            position: 'sticky',
            top: 0,
            background: colors.white,
            borderBottom: `1px solid ${colors.gray200}`,
            padding: '12px 24px',
            zIndex: 100,
          }}>
            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', gap: 16, marginBottom: isGalleryView ? 12 : 0 }}>
              <div style={{ display: 'flex', gap: 6, alignItems: 'center' }}>
                {/* Gallery tab first */}
                <button
                  onClick={() => setActiveApp('gallery')}
                  style={{
                    padding: '6px 14px',
                    borderRadius: 16,
                    border: isGalleryView ? 'none' : `2px solid ${themes[currentTheme].accent}`,
                    background: isGalleryView ? themes[currentTheme].accent : colors.white,
                    color: isGalleryView ? colors.white : themes[currentTheme].accent,
                    fontSize: 12,
                    fontWeight: 700,
                    cursor: 'pointer',
                    whiteSpace: 'nowrap',
                  }}
                >
                  üìÅ Gallery
                </button>
                <div style={{ width: 1, height: 20, background: colors.gray200, margin: '0 6px' }} />
                {/* Category filter for non-gallery view */}
                {!isGalleryView && (
                  <select
                    value={activeCategory}
                    onChange={(e) => setActiveCategory(e.target.value)}
                    style={{
                      padding: '6px 12px',
                      borderRadius: 16,
                      border: `1px solid ${colors.gray300}`,
                      background: colors.white,
                      fontSize: 12,
                      fontWeight: 600,
                      color: colors.gray700,
                      cursor: 'pointer',
                    }}
                  >
                    <option value="all">All Industries</option>
                    {categories.map(cat => (
                      <option key={cat} value={cat}>{cat}</option>
                    ))}
                  </select>
                )}
              </div>
              {!isGalleryView && (
                <button
                  onClick={exportToPNG}
                  disabled={exporting}
                  style={{
                    padding: '8px 16px',
                    borderRadius: 20,
                    border: 'none',
                    background: exporting ? colors.gray200 : themes[currentTheme].accent,
                    color: exporting ? colors.gray500 : colors.white,
                    fontSize: 13,
                    fontWeight: 600,
                    cursor: exporting ? 'not-allowed' : 'pointer',
                    display: 'flex',
                    alignItems: 'center',
                    gap: 6,
                  }}
                >
                  {exporting ? 'Exporting...' : '‚Üì Download PNG'}
                </button>
              )}
            </div>
            {/* App tabs - show when not in gallery */}
            {!isGalleryView && (
              <div style={{ display: 'flex', gap: 6, flexWrap: 'wrap' }}>
                {filteredApps.map(app => (
                  <button
                    key={app.id}
                    onClick={() => setActiveApp(app.id)}
                    style={{
                      padding: '6px 12px',
                      borderRadius: 16,
                      border: 'none',
                      background: activeApp === app.id ? themes[currentTheme].accent : colors.gray100,
                      color: activeApp === app.id ? colors.white : colors.gray600,
                      fontSize: 12,
                      fontWeight: 600,
                      cursor: 'pointer',
                      whiteSpace: 'nowrap',
                    }}
                  >
                    {app.label}
                  </button>
                ))}
              </div>
            )}
          </div>

          {/* Gallery View */}
          {isGalleryView ? (
            <div style={{ padding: '40px 60px' }}>
              {/* Gallery Controls */}
              <div style={{
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'flex-start',
                marginBottom: 32,
                flexWrap: 'wrap',
                gap: 16,
              }}>
                <div style={{ display: 'flex', alignItems: 'flex-start', gap: 24, flexWrap: 'wrap' }}>
                  <ThemePicker currentTheme={currentTheme} onSelect={setCurrentTheme} />
                  {/* Category Filter */}
                  <div>
                    <div style={{
                      fontSize: 11,
                      fontWeight: 700,
                      color: colors.gray500,
                      textTransform: 'uppercase',
                      letterSpacing: 1.2,
                      marginBottom: 12,
                    }}>
                      Industry
                    </div>
                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: 6 }}>
                      <button
                        onClick={() => setActiveCategory('all')}
                        style={{
                          padding: '6px 12px',
                          borderRadius: 16,
                          border: 'none',
                          background: activeCategory === 'all' ? themes[currentTheme].accent : colors.gray100,
                          color: activeCategory === 'all' ? colors.white : colors.gray600,
                          fontSize: 11,
                          fontWeight: 600,
                          cursor: 'pointer',
                        }}
                      >
                        All ({apps.length})
                      </button>
                      {categories.map(cat => {
                        const count = apps.filter(a => a.category === cat).length;
                        return (
                          <button
                            key={cat}
                            onClick={() => setActiveCategory(cat)}
                            style={{
                              padding: '6px 12px',
                              borderRadius: 16,
                              border: 'none',
                              background: activeCategory === cat ? themes[currentTheme].accent : colors.gray100,
                              color: activeCategory === cat ? colors.white : colors.gray600,
                              fontSize: 11,
                              fontWeight: 600,
                              cursor: 'pointer',
                            }}
                          >
                            {cat} ({count})
                          </button>
                        );
                      })}
                    </div>
                  </div>
                </div>
                <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>
                  <button
                    onClick={selectAll}
                    style={{
                      padding: '8px 16px',
                      borderRadius: 20,
                      border: `1px solid ${colors.gray300}`,
                      background: colors.white,
                      color: colors.gray600,
                      fontSize: 13,
                      fontWeight: 600,
                      cursor: 'pointer',
                    }}
                  >
                    Select All
                  </button>
                  <button
                    onClick={selectNone}
                    style={{
                      padding: '8px 16px',
                      borderRadius: 20,
                      border: `1px solid ${colors.gray300}`,
                      background: colors.white,
                      color: colors.gray600,
                      fontSize: 13,
                      fontWeight: 600,
                      cursor: 'pointer',
                    }}
                  >
                    Clear
                  </button>
                  <button
                    onClick={exportSelected}
                    disabled={exporting || selectedCount === 0}
                    style={{
                      padding: '8px 20px',
                      borderRadius: 20,
                      border: 'none',
                      background: (exporting || selectedCount === 0) ? colors.gray200 : themes[currentTheme].accent,
                      color: (exporting || selectedCount === 0) ? colors.gray500 : colors.white,
                      fontSize: 13,
                      fontWeight: 600,
                      cursor: (exporting || selectedCount === 0) ? 'not-allowed' : 'pointer',
                      display: 'flex',
                      alignItems: 'center',
                      gap: 6,
                    }}
                  >
                    {exporting ? 'Exporting...' : `‚Üì Download ${selectedCount > 0 ? `(${selectedCount})` : 'Selected'}`}
                  </button>
                </div>
              </div>

              {/* Gallery Grid */}
              <div style={{
                display: 'grid',
                gridTemplateColumns: 'repeat(auto-fill, minmax(360px, 1fr))',
                gap: 32,
              }}>
                {filteredApps.map(app => (
                  <div key={app.id} style={{ position: 'relative' }}>
                    {/* Checkbox */}
                    <label style={{
                      position: 'absolute',
                      top: -12,
                      left: -12,
                      zIndex: 10,
                      display: 'flex',
                      alignItems: 'center',
                      gap: 8,
                      background: colors.white,
                      padding: '6px 12px',
                      borderRadius: 20,
                      boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                      cursor: 'pointer',
                    }}>
                      <input
                        type="checkbox"
                        checked={selectedForExport[app.id] || false}
                        onChange={() => toggleExportSelection(app.id)}
                        style={{
                          width: 18,
                          height: 18,
                          accentColor: themes[currentTheme].accent,
                          cursor: 'pointer',
                        }}
                      />
                      <span style={{ fontSize: 12, fontWeight: 600, color: colors.gray700 }}>
                        {app.label}
                      </span>
                      <span style={{ fontSize: 10, color: colors.gray400, marginLeft: 4 }}>
                        {app.category}
                      </span>
                    </label>
                    {/* App Card */}
                    <div 
                      ref={el => galleryRefs.current[app.id] = el}
                      style={{
                        display: 'inline-block',
                      }}
                    >
                      {renderAppById(app.id)}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          ) : (
            /* Single App View */
            <div style={{ 
              padding: 60, 
              display: 'flex', 
              gap: 60,
              justifyContent: 'center',
              alignItems: 'flex-start',
              flexWrap: 'wrap',
            }}>
              {/* Theme Picker */}
              <div style={{ 
                background: colors.white, 
                padding: 24, 
                borderRadius: 16,
                boxShadow: '0 4px 12px rgba(0,0,0,0.06)',
              }}>
                <ThemePicker currentTheme={currentTheme} onSelect={setCurrentTheme} />
              </div>

              {/* Micro App Display */}
              <div>
                <h2 style={{ 
                  textAlign: 'center', 
                  marginBottom: 24, 
                  color: colors.gray400, 
                  fontSize: 12, 
                  textTransform: 'uppercase', 
                  letterSpacing: 2 
                }}>
                  {apps.find(a => a.id === activeApp)?.label}
                </h2>
                
                <div ref={appRef}>
                  {renderApp()}
                </div>
              </div>
            </div>
          )}
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>